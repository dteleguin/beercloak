version: '3.7'
services:
  keycloak:
    container_name: beercloak
    image: "quay.io/keycloak/keycloak:${KEYCLOAK_VERSION}"
    ports:
    - 18080:8080
    environment:
      KC_HTTP_RELATIVE_PATH: /auth
      KEYCLOAK_ADMIN: admin
      KEYCLOAK_ADMIN_PASSWORD: keycloak
      KEYCLOAK_IMPORT: /opt/jboss/keycloak/imports/beer-realm.json
    command: start-dev
    volumes:
    - /etc/localtime:/etc/localtime:ro
    - "./beercloak-module/target/beercloak-module-docker.jar:/opt/keycloak/providers/beercloak.jar"
    - "./beercloak-module/src/main/resources/theme/beer:/opt/keycloak/themes/beer"
    - "./test/beer-realm.json:/opt/keycloak/imports/beer-realm.json"
    networks:
    - beernet

  maildev:
    container_name: maildev
    image: maildev/maildev:1.1.0
    ports:
    - "1080:80"
    - "1234:25"
    networks:
    - beernet

networks:
  beernet:
    driver: bridge
    ipam:
      driver: default
      config:
      - subnet: 172.18.0.0/16
